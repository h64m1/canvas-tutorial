<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Canvas tutorial</title>
		<script type="text/javascript">
			function draw() {
				const canvas = document.getElementById('drag-drop')
				if (canvas.getContext) {
					// drawing code here
					const ctx = canvas.getContext('2d')

					let initW = 50
					let initH = 50
					let initX = 100
					let initY = 100

					let isDrag = false
					let w = initW
					let h = initH
					let x = initX
					let y = initY
					let relX = 0
					let relY = 0
					ctx.fillRect(x, y, w, h)

					function onDown(e) {
						const _x = e.clientX - canvas.offsetLeft
						const _y = e.clientY - canvas.offsetTop

						if ( _x >= x && _x <= x + w && _y >= y && _y <= y + h) {
							isDrag = true
							relX = x - _x
							relY = y - _y
							console.debug('drag start', _x, _y, 'rel', relX, relY)
						}
					}

					function onMove(e) {
						// drag end point
						const _x = e.clientX - canvas.offsetLeft
						const _y = e.clientY - canvas.offsetTop

						if (!isDrag) {
							return
						}

						x = _x + relX
						y = _y + relY

						// clear canvas
						ctx.clearRect(0, 0, canvas.width, canvas.height)
						ctx.fillRect(x, y, w, h)
					}

					function onUp(e) {
						isDrag = false
						console.debug('drag stop', x, y)
					}

					function onOut(e) {
						isDrag = false
						console.debug('out: drag stop', x, y)
					}

					canvas.addEventListener('mousedown', onDown, false)
					canvas.addEventListener('mousemove', onMove, false)
					canvas.addEventListener('mouseup', onUp, false)
					canvas.addEventListener('mouseout', onOut, false)
				} else {
					// canvas-unsupported code here
				}
			}
		</script>
		<style type="text/css">
			canvas {
				border: 1px solid black;
			}
		</style>
	</head>
	<body onload="draw();">
		<!-- <canvas id="tutorial" width="150" height="150"></canvas> -->
		<!-- default canvas size: width=300, height=150 -->
		<!-- Providing fallback content is very straightforward: just insert the alternate content inside the <canvas> element. -->
		<!-- Browsers that don't support <canvas> will ignore the container and render the fallback content inside it. -->
		<!-- Browsers that do support <canvas> will ignore the content inside the container, and just render the canvas normally. -->
		<canvas id="drag-drop" width="1000" height="1000"> canvas tutorial </canvas>
	</body>
</html>
